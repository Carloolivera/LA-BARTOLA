# =====================================================
# REDIRECCION A LA CARPETA PUBLIC
# =====================================================
# Este archivo va en la RAIZ de public_html/
# Redirige todo el tráfico a la carpeta public/
# donde está el verdadero index.php de CodeIgniter
# =====================================================

<IfModule mod_rewrite.c>
    RewriteEngine On

    # Redirigir al index de /public si se accede a la raíz
    RewriteRule ^$ public/ [L]

    # Redirigir todo lo demás a /public excepto lo que ya está ahí
    RewriteRule ^((?!public/).*)$ public/$1 [L,NC]
</IfModule>

# =====================================================
# SEGURIDAD: Proteger archivos sensibles
# =====================================================

# Denegar acceso a .env
<Files .env>
    Order allow,deny
    Deny from all
</Files>

# Denegar acceso a archivos de configuración
<FilesMatch "^(composer\.(json|lock)|\.gitignore)$">
    Order allow,deny
    Deny from all
</FilesMatch>

# Deshabilitar listado de directorios
Options -Indexes

# =====================================================
# OPTIMIZACIONES
# =====================================================

# Habilitar compresión GZIP
<IfModule mod_deflate.c>
    AddOutputFilterByType DEFLATE text/html text/plain text/xml text/css text/javascript application/javascript application/json
</IfModule>

# Cache de archivos estáticos
<IfModule mod_expires.c>
    ExpiresActive On
    ExpiresByType image/jpg "access plus 1 year"
    ExpiresByType image/jpeg "access plus 1 year"
    ExpiresByType image/gif "access plus 1 year"
    ExpiresByType image/png "access plus 1 year"
    ExpiresByType image/webp "access plus 1 year"
    ExpiresByType text/css "access plus 1 month"
    ExpiresByType application/javascript "access plus 1 month"
    ExpiresByType application/pdf "access plus 1 month"
</IfModule>
